<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login - Library Reading Challenge</title>
</head>
<body>
<h2>Login</h2>
<form id="loginForm">
  <input type="text" id="borrowerNumber" placeholder="Borrower Number" required><br>
  <input type="password" id="password" placeholder="Password" required><br>
  <button type="submit">Login</button>
</form>
<div id="errorBox" style="color:red;"></div>

<script>
const endpoint = 'https://script.google.com/macros/s/AKfycbwdVUVEBlUXk4P4zJ-tV6NM-UulEPJMt-QRrWRvagBUQkvjSbgo5Lkmmqz8jaeRy3Xh/exec';

document.getElementById('loginForm').addEventListener('submit', async e => {
  e.preventDefault();
  const borrowerNumber = document.getElementById('borrowerNumber').value.trim();
  const password = document.getElementById('password').value.trim();
  const errorBox = document.getElementById('errorBox');
  errorBox.textContent = '';

  const response = await fetch(`${endpoint}?action=login`, {
    method: 'POST',
    body: JSON.stringify({ borrowerNumber, password }),
    headers: { 'Content-Type': 'application/json' }
  });
  const data = await response.json();

  if(data.success){
    sessionStorage.setItem('userName', data.name);
    sessionStorage.setItem('booksRead', data.booksRead);
    sessionStorage.setItem('points', data.points);
    window.location.href = 'dashboard.html';
  } else {
    errorBox.textContent = data.message;
  }
});
</script>
</body>
</html>
